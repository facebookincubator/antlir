name: CI

on: [push, pull_request]

jobs:
  smoke-test:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2

      - name: Checkout submodules
        run: git submodule update --init

      - name: Fetch buck
        run: ./tools/buck --version

      - name: Fetch remote artifacts
        run: ./tools/buck fetch //...

      # Not every target can compile currently, so just build a set of example
      # image(s) that are known to work right now
      - name: Build example images
        run: ./tools/buck build //images/examples/...
